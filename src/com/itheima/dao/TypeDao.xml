<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itheima.dao.TypeDao" >

    <!--通过typename获得type_id-->
    <select id="findName"  parameterType="String" resultType="Integer">
        select type_id from type where typename=#{name}
    </select>

    <!--查询某一类型的书籍-->
    <select id="findTB"  parameterType="Integer" resultMap="TypeBook">
        select * from book b,type t where b.type_id=t.type_id
        <if test="id!=-1">
            and  t.type_id=#{id}
        </if>
    </select>
    <resultMap id="TypeBook" type="Type">
        <id property="type_id" column="type_id"></id>
        <result property="typename" column="typename"></result>
        <collection property="book" ofType="Book">
            <id property="book_id" column="book_id"></id>
            <result property="bookname" column="bookname"></result>
            <result property="image" column="image"></result>
            <result property="blurb" column="blurb"></result>
        </collection>
    </resultMap>

    <!--新增类型-->
    <insert id="addType" parameterType="String">
        insert into type(typename) value(#{name})
    </insert>

</mapper>